<div class="ui massive menu icon  blue inverted">
  <button [attr.disabled]='isMonitoring?true:null' class="item sidebarToggle"><i class='ui icon bars' id='sidebar-button'></i></button>
  <ng-container *ngIf='currentSession != undefined'>
    <div class="ui massive header item">ID:{{currentSession.session_id}}</div>
    <div class="ui massive header item"> Допуск: {{currentSession.tolerance}}</div>
    <button [attr.disabled]='isMonitoring?true:null' class='ui item header item' (click)='openModalEditSession()'><i
        class='icon pencil'></i></button>
    <div *ngIf='state != "" ' class='ui item header'>Стан: {{state}}</div>
  </ng-container>
  <div class="right menu">
    <button [attr.disabled]='isMonitoring?true:null' class='ui item header item bt-devices'><i [ngClass]='{green: (connectBT && currentConfig!=undefined), red: (!connectBT || currentConfig==undefined)}'
        class='icon bluetooth b'></i></button>
    <div class="ui fluid popup bottom left transition hidden bt-devices-popup">
      <h1>Bluetooth прилади</h1>
      <i class='blue huge x icon' data-content='Top Right' dat-position='top right' (click)='closeBTPopup()'></i>
      <h3 *ngIf='currentConfig!=undefined'>Поточний прилад - {{currentConfig.bt_name}}</h3>
      <div class="ui huge blue button" *ngFor='let BTDevice of currentBTDevices; let i = index' id='{{i}}' (click)='selectBT(BTDevice, i)'>
        <h2>{{BTDevice.name}}</h2>
      </div>
      <!--<div *ngIf='currentConfig!=undefined' class="ui toggle large checkbox">
        <input type="checkbox" name="public" checked>
        <label>
          <h3>Обрати поточний</h3>
        </label>
      </div>-->
      <div class="ui inverted dimmer ">
        <div class="ui large loader"></div>
      </div>
      <!--<label *ngIf='currentConfig!=undefined'>{{currentConfig.bt_name}}</label>-->
      <div class='btn-container'>
        <button class='ui massive button blue' (click)='getBT()' tabindex="0">Пошук</button>
        <button class='ui massive button blue' (click)='setBT(currentBTBuffer)' tabindex="0" [attr.disabled]='(currentBTBuffer == undefined || isEmpty(currentBTBuffer))? true : null'>Підтвердити</button>
      </div>

    </div>
  </div>

</div>

<div class='ui pushable'>
  <div class="ui left blue inline sidebar inverted vertical menu">
    <a class="item ui header sidebarToggle">
      <h1>Меню</h1>
    </a>
    <a class="item ui header sidebarToggle" (click)='openModalArchive()'>
      <h2>Відкрити</h2>
    </a>
    <a class="item ui header sidebarToggle" (click)='openSessionCreation()'>
      <h2>Створити</h2>
    </a>
    <a class="item ui header sidebarToggle" (click)='openSessionDeletion()'>
      <h2>Видалити</h2>
    </a>
    <a class="item ui header sidebarToggle" (click)='openSessionClosing()'>
      <h2>Завершити роботу</h2>
    </a>
    <a class="item ui header sidebarToggle">
      <h2>Експорт</h2>
    </a>
    <a class="item ui header sidebarToggle" (click)='openMailCreation()'>
      <h2>Пошта</h2>
      <h5 *ngIf='currentConfig==undefined || currentConfig==null '>Додайте электронну пошту</h5>
      <h4 *ngIf='currentConfig!=undefined && currentConfig!=null '>{{currentConfig?.email}}</h4>
    </a>
  </div>
  <div class='pusher'>
    <div class='ui container'>
      <form *ngIf="targets!=undefined" class='ui form'>
        <div class='fields'>
          <div class="field three  ui  input disabled">
            <input [(ngModel)]="params.x" [ngModelOptions]="{standalone: true}" pattern="[0-9]{1,4}" type="number"
              placeholder="X">
          </div>
          <div class="field three  ui  input disabled">
            <input [(ngModel)]="params.y" [ngModelOptions]="{standalone: true}" pattern="[0-9]{1,4}" type="number"
              placeholder="Y">
          </div>
          <div class="field three  ui  input disabled">
            <input [(ngModel)]="params.h" [ngModelOptions]="{standalone: true}" pattern="[0-9]{1,4}" type="number"
              placeholder="H">
          </div>
          <div class="field three">
            <button class='ui blue button massive' (click)='changeTargetType(params.type)'>{{params.type}}</button>
          </div>
          <div class="field four">
            <button class='ui blue button massive' (click)='getCoordinates()'>Поміряти</button>
          </div>
          <div class="field four">
            <button class='ui blue button massive' (click)='addTarget()'>Додати</button>
          </div>
        </div>
      </form>

      <table *ngIf="targets!=undefined" class='ui blue large table celled stripped target-table'>
        <thead>
          <tr class='center aligned'>
            <th></th>
            <th>
              <h2>#</h2>
            </th>
            <th>
              <h2>X</h2>
            </th>
            <th>
              <h2>Y</h2>
            </th>
            <th>
              <h2>Z</h2>
            </th>
            <th>
              <h2>&#9651;X</h2>
            </th>
            <th>
              <h2>&#9651;Y</h2>
            </th>
            <th>
              <h2>&#9651;Z</h2>
            </th>
            <th>
              <h2>Час</h2>
            </th>
          </tr>

        </thead>
        <tbody>
          <tr class='center aligned' *ngFor='let target of targets' [ngClass]='{error:checkDelta(target)}'>
            <td class="delete-col collapsing" (click)='deleteTarget(target)'>
              <button [attr.disabled]='isMonitoring?true:null'>
                <i class="icon large trash alternate"></i></button>
              <!--<div class='ui button massive blue icon'><i class="icon pencil alternate"></i></div>-->
              <!--<div class='ui button huge blue icon' (click)='deleteTarget(target)'><i class="icon trash alternate"></i></div>-->
            </td>
            <td>
              <h3>{{target.target_id}}</h3>
            </td>
            <td>
              <h3>{{target.X0.toFixed(4)}}</h3>
            </td>
            <td>
              <h3>{{target.Y0.toFixed(4)}}</h3>
            </td>
            <td>
              <h3>{{target.H0.toFixed(4)}}</h3>
            </td>
            <td>
              <h3>{{target.dX.toFixed(4)}}</h3>
            </td>
            <td>
              <h3>{{target.dY.toFixed(4)}}</h3>
            </td>
            <td>
              <h3>{{target.dH.toFixed(4)}}</h3>
            </td>
            <td>
              <h3>{{target.last_upd | date:'medium'}}</h3>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

</div>

<div class='ui modal notification'>
  <div class="header">Попередження</div>
  <div class='content'>
    <h3 class='ui header'>Активні сесії відсутні. Створіть нову або оберіть сесію з архіву.</h3>
  </div>
  <div class='actions'>
    <a class='ui massive cancel blue button'>Створити нову сесію</a>
    <a class='ui massive ok button'>Відкрити сесію з архіву</a>
  </div>
</div>

<div class='ui modal history'>
  <div class="header">Архів сесій</div>
  <div class='content'>
    <div class="ui fluid selection dropdown input massive">
      <input type="hidden" name="user">
      <i class="dropdown icon"></i>
      <div class="default text">Оберіть Id сесії</div>
      <div class="menu ">
        <ng-container *ngFor='let archiveSession of archiveSessions'>
          <div class="item" (click)='selectSessionId(archiveSession.session_id)'>
            <h1>{{archiveSession.session_id}}</h1>
          </div>
        </ng-container>

      </div>

    </div>

  </div>
  <div class="actions">
    <button [disabled]='selectSessionId == undefined' class='ui massive ok blue button' (click)='openSession()'>Підтвердити</button>
    <a class='ui massive cancel button'>Відмінити</a>
  </div>
</div>

<div class='ui modal creator'>
  <div class="header">Створити нову сесію</div>
  <div class='content'>
    <form class='ui form'>
      <!-- <div class='fields'> -->

      <div class="field">
        <label>Допуск</label>
        <input value="0.01" id="dopusk" pattern="[0-9]{1,4}" type="number" required>
      </div>
      <div class="field">
        <label>Опис</label>
        <textarea id="description" rows="1" maxlength="50" required></textarea>
      </div>

      <!-- </div> -->
    </form>
  </div>
  <div class="actions">
    <a class='ui massive ok blue button' (click)='createSession()'>Підтвердити</a>
    <a class='ui massive cancel button'>Відмінити</a>
  </div>
</div>
<div class='ui modal email'>
  <div class="header">Редагування пошти</div>
  <div class='content'>
    <form class='ui form'>

      <div class="field ">
        <label>Електронна пошта</label>
        <input id="alarmEmail" type="email">
      </div>
      <div class="field ">
        <label>Поштовий сервер</label>
        <input id="mailServer">
      </div>
      <div class="field ">
        <label>Порт</label>
        <input id="mailPort">
      </div>
      <div class="field ">
        <label>Логін</label>
        <input id="mailLogin">
      </div>
      <div class="field ">
        <label>Пароль</label>
        <input id="mailPassword" type="password">
      </div>
      <div class="inline fields">
        <div class="field ">
          <label>SSL</label>
          <input id="mailSsl" type="checkbox">
        </div>
        <div class="field ">
          <label>TLS</label>
          <input id="mailTls" type="checkbox">
        </div>
      </div>
    </form>
  </div>
  <div class="actions">
    <a class='ui massive ok blue button' (click)='editMail()'>Підтвердити</a>
    <a class='ui massive cancel button'>Відмінити</a>
    <!-- <a class='ui cancel button'>Повернутись</a> -->
  </div>
</div>
<div class='ui modal edit session'>
  <div class="header">Редагування допуску</div>
  <div class='content'>
    <form class='ui form'>

      <div class="field ">
        <label>Допуск</label>
        <input id="editDopusk" pattern="[0-9]{1,4}" type="number">

      </div>
      <div class="field">
        <label>Опис</label>
        <textarea id="editDescription" rows="1" maxlength="50" required></textarea>
      </div>

    </form>
  </div>
  <div class="actions">
    <a class='ui massive ok blue button' (click)='editSession()'>Підтвердити</a>
    <a class='ui massive cancel button'>Відмінити</a>
    <!-- <a class='ui cancel button'>Повернутись</a> -->
  </div>
</div>
<div class='ui modal warning'>
  <div class="header">Змінити поточну сесію</div>
  <div class='content'>
    <h3 class='ui header'>Ви хочете змінити поточну сесію?</h3>
  </div>
  <div class='actions'>
    <a class='ui massive blue ok button' (click)='openOtherSession()'>Продовжити</a>
    <a class='ui massive cancel button'>Відмінити</a>
  </div>
</div>

<div class='ui modal close'>
  <div class="header">Завершення роботи</div>
  <div class='content'>
    <h3 class='ui header'>Ви хочете завершити поточну сесію? Прилад буде вимкнено!</h3>
  </div>
  <div class='actions'>
    <a class='ui massive blue ok button' (click)='closeSession()'>Продовжити</a>
    <a class='ui massive cancel button'>Відмінити</a>
  </div>
</div>

<div class='ui modal confirm'>
  <div class="header">Ви впевнені?</div>
  <div class='content'>
    <h3 class='ui header'>Сесія {{selectedSessionIdDelete}} буде видалена назавжди!</h3>
  </div>
  <div class='actions'>
    <a class='ui massive blue ok button' (click)='deleteSession()'>Продовжити</a>
    <a class='ui massive cancel button'>Відмінити</a>
  </div>
</div>

<div class='ui modal delete'>
  <div class="header">Видалення сесії</div>
  <div class='content'>
    <div class="ui fluid deletion dropdown input massive">
      
      <i class="dropdown icon"></i>
      <div class="default text">Оберіть Id сесії</div>
      <div class="menu ">
        <ng-container *ngFor='let archiveSession of archiveSessions | filter:selectedSessionId'>
          <div class="item" (click)='selectSessionIdDelete(archiveSession.session_id)'>
            <h1>{{archiveSession.session_id}}</h1>
          </div>
        </ng-container>

      </div>

    </div>
  </div>
  <div class='actions'>
    <a class='ui massive blue ok button' (click)='openDeleteConfirm()'>Видалити</a>
    <a class='ui massive cancel button'>Відмінити</a>
  </div>
</div>

<div *ngIf="!isMonitoring && targets!=undefined && targets.length!=0">
  <button class='ui button circular blue massive icon play-button' (click)='runMonitoring()'><i class='icon play'></i></button>
</div>
<div *ngIf="isMonitoring">
  <button class='ui button circular blue massive icon play-button' (click)='stopMonitoring()'><i class='icon stop'></i></button>
</div>